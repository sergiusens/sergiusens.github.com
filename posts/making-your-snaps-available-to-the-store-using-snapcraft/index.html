<!DOCTYPE html>
<html lang="en-us" />
<head>
    <meta http-equiv="Content-Type" content="text/html" charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />

    <title>Making your snaps available to the store using snapcraft &middot; </title>

    <meta name="HandheldFriendly" content="True" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <link rel="shortcut icon" href="../../favicon.ico" />
    <link rel="canonical" href="../../" />

     <meta name="description" content="Now that Ubuntu Core has been officially released, it might be a good time to get your snaps into the Store.
Delivery and Store Concepts So let&amp;rsquo;s start wi" /> 

     
    
    <meta name="twitter:card" content="summary"/>
    
 
    <meta name="twitter:title" content="Making your snaps available to the store using snapcraft"/>
    <meta name="twitter:description" content="Now that Ubuntu Core has been officially released, it might be a good time to get your snaps into the Store.
Delivery and Store Concepts So let&amp;rsquo;s start wi"/>
    <meta name="twitter:url" content="/posts/making-your-snaps-available-to-the-store-using-snapcraft/" />
    <meta name="twitter:site" content="@sergiusens"/>

    <meta property="og:site_name" content="" />
    <meta property="og:title" content="Making your snaps available to the store using snapcraft &middot; I me mine" />
    <meta property="og:url" content="/posts/making-your-snaps-available-to-the-store-using-snapcraft/" />
    

    <meta property="og:type" content="article" />
    <meta property="og:description" content="Now that Ubuntu Core has been officially released, it might be a good time to get your snaps into the Store.
Delivery and Store Concepts So let&amp;rsquo;s start wi" />

    <meta property="article:published_time" content="2016-11-04T13:58:35&#43;02:00" />
    <meta property="article:tag" content="snappy" /><meta property="article:tag" content="snapcraft" />

    <meta property="og:image" content="img/banner.jpg"/>

    <meta name="generator" content="Hugo 0.45.1" />

    <!-- Stylesheets -->
    <link rel="stylesheet" type="text/css" href="../../built/screen.css" /> 
    <link rel="stylesheet" type="text/css" href="../../css/casper-two.css" /> 
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css" />
    

     

</head>


<body class="ctsingle">

  <div class="site-wrapper"> 

<header class="site-header outer "  style="background-image: url(/img/banner.jpg)"  >
  <div class="inner">
    <div class="site-header-content">
      <h1 class="site-title"> I me mine  </h1>
        <h2 class="site-description">A placeholder to write things down </h2>
    </div>

    <nav class="site-nav">
      <div class="site-nav-left"><ul class="nav" role="menu">
        
        
      </ul></div>

      <div class="site-nav-right">
        <div class="social-links">
                    

                    <a class="social-link social-link-tw" href="https://twitter.com/sergiusens" target="_blank" rel="noopener"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><path d="M30.063 7.313c-.813 1.125-1.75 2.125-2.875 2.938v.75c0 1.563-.188 3.125-.688 4.625a15.088 15.088 0 0 1-2.063 4.438c-.875 1.438-2 2.688-3.25 3.813a15.015 15.015 0 0 1-4.625 2.563c-1.813.688-3.75 1-5.75 1-3.25 0-6.188-.875-8.875-2.625.438.063.875.125 1.375.125 2.688 0 5.063-.875 7.188-2.5-1.25 0-2.375-.375-3.375-1.125s-1.688-1.688-2.063-2.875c.438.063.813.125 1.125.125.5 0 1-.063 1.5-.25-1.313-.25-2.438-.938-3.313-1.938a5.673 5.673 0 0 1-1.313-3.688v-.063c.813.438 1.688.688 2.625.688a5.228 5.228 0 0 1-1.875-2c-.5-.875-.688-1.813-.688-2.75 0-1.063.25-2.063.75-2.938 1.438 1.75 3.188 3.188 5.25 4.25s4.313 1.688 6.688 1.813a5.579 5.579 0 0 1 1.5-5.438c1.125-1.125 2.5-1.688 4.125-1.688s3.063.625 4.188 1.813a11.48 11.48 0 0 0 3.688-1.375c-.438 1.375-1.313 2.438-2.563 3.188 1.125-.125 2.188-.438 3.313-.875z"/></svg></a>

                    <a class="social-link" href="https://github.com/sergiusens" target="_blank" rel="noopener"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"/></svg></a>

                    <a class="social-link" href="https://www.linkedin.com/in/SergioSchvezov" target="_blank" rel="noopener"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 50 512 512"><path d="M150.65,100.682c0,27.992-22.508,50.683-50.273,50.683c-27.765,0-50.273-22.691-50.273-50.683 C50.104,72.691,72.612,50,100.377,50C128.143,50,150.65,72.691,150.65,100.682z M143.294,187.333H58.277V462h85.017V187.333z M279.195,187.333h-81.541V462h81.541c0,0,0-101.877,0-144.181c0-38.624,17.779-61.615,51.807-61.615 c31.268,0,46.289,22.071,46.289,61.615c0,39.545,0,144.181,0,144.181h84.605c0,0,0-100.344,0-173.915 s-41.689-109.131-99.934-109.131s-82.768,45.369-82.768,45.369V187.333z" /></svg></a>

                    
        </div>  
            
      </div>

    </nav>  

  </div>
</header>


<main id="site-main" class="site-main outer" role="main">
  <div class="inner">
    
    <div class="post-feed">
      <article class="post-card post"> 
    
    <a class="post-card-image-link" href="../../posts/making-your-snaps-available-to-the-store-using-snapcraft/">
      <div class="post-card-image" style="background-image: url(/defimg/7.jpg)"></div>
    </a>    
    

    <div class="post-card-content">
      <a class="post-card-content-link" href="../../posts/making-your-snaps-available-to-the-store-using-snapcraft/">
          <header class="post-card-header">
              <span class="post-card-tags">
              #snappy 
              #snapcraft  </span>
              
              <h2 class="post-card-title">Making your snaps available to the store using snapcraft</h2>
          </header>
      </a>
      <section class="post-card-excerpt" style="padding: 0 25px;">
          4 November 2016
          

<p>Now that <a href="https://www.ubuntu.com/core">Ubuntu Core</a> has been <a href="https://insights.ubuntu.com/2016/11/03/ubuntu-core-16-delivers-foundation-for-secure-iot/">officially released</a>, it might be a good
time to get your snaps into the Store.</p>

<h1 id="delivery-and-store-concepts">Delivery and Store Concepts</h1>

<p>So let&rsquo;s start with a refresher on what we have available on the Store
side to manage your snaps.</p>

<p>Every time you push a snap to the store, the store will assign it
a revision, this revision is unique in the store for this particular
snap.</p>

<p>However to be able to push a snap for the first time, the <strong>name</strong>
needs to be registered which is pretty easy to do given the name is
not already taken.</p>

<p>Any revision on the store can be released to a number of channels which
are defined conceptually to give your users the idea of a stability
or risk level, these channel names are:</p>

<ul>
<li>stable</li>
<li>candidate</li>
<li>beta</li>
<li>edge</li>
</ul>

<p>Ideally anyone with a CI/CD process would push daily or on every
source update to the <strong>edge</strong> channel. During this process there are two
things to take into account.</p>

<p>The first thing to take into account is that at the beginning of the
snapping process you will likely get started with a non confined snap
as this is where the bulk of the work needs to happen to adapt to
this new paradigm.
With that in mind, your project gets started with a <code>confinement</code> set to
<code>devmode</code>. This makes it possible to get going on the early phases
of development and still get your snap into the store. Once everything
is fully supported with the security model snaps work in, this
<code>confinement</code> entry can be switched to <code>strict</code>. Given the <code>confinement</code>
level of <code>devmode</code> this snap is only releasable on the <code>edge</code> and <code>beta</code>
channels which hints your users on how much risk they are taking by
going there.</p>

<p>So let&rsquo;s say you are good to go on the confinement side and you start
a CI/CD process against <code>edge</code> but you also want to make sure in some
cases that early releases of a new iteration against master never make
it to <code>stable</code> or <code>candidate</code> and for this we have a <code>grade</code> entry. If
the <code>grade</code> of the snap is set to <code>devel</code> the store will never allow you
to release to the most stable channels (<code>stable</code> and <code>candidate</code>).
not be possible.</p>

<p>Somewhere along the way we might want to release a revision into beta
which some users are more likely want to track on their side (which
given good release management process should be to some level more
usable than a random daily build). When that stage in the process is over
but want people to keep getting updates we can choose to <code>close</code> the
<code>beta</code> channel as we only plan to release to <code>candidate</code> and <code>stable</code>
from a certain point in time, by closing this <code>beta</code> channel we will
make that channel track the following open channel in the stability
list, in this case it is <code>candidate</code>, if <code>candidate</code> is tracking
<code>stable</code> whatever is in <code>stable</code> is what we will get.</p>

<h1 id="enter-snapcraft">Enter Snapcraft</h1>

<p>So given all these concepts how do we get going with <code>snapcraft</code>, first of
all we need to <code>login</code>:</p>

<pre><code>$ snapcraft login
Enter your Ubuntu One SSO credentials.
Email: sxxxxx.sxxxxxx@canonical.com
Password: **************
Second-factor auth: 123456
</code></pre>

<p>After logging in we are ready to get our snap registered, for examples sake
let&rsquo;s say we wanted to register <code>awesome-database</code>, a fantasy snap we want
to get started with:</p>

<pre><code>$ snapcraft register awesome-database
We always want to ensure that users get the software they expect
for a particular name.

If needed, we will rename snaps to ensure that a particular name
reflects the software most widely expected by our community.

For example, most people would expect ‘thunderbird’ to be published by
Mozilla. They would also expect to be able to get other snaps of
Thunderbird as 'thunderbird-sergiusens'.

Would you say that MOST users will expect 'a' to come from
you, and be the software you intend to publish there? [y/N]: y

You are now the publisher for 'awesome-database'.
</code></pre>

<p>So assuming we have the snap built already, all we have to do is
<code>push</code> it to the store. Let&rsquo;s take advantage of a shortcut and <code>--release</code>
in the same command:</p>

<pre><code>$ snapcraft push awesome-databse_0.1_amd64.snap --release edge
Uploading awesome-database_0.1_amd64.snap [=================] 100%
Processing....
Revision 1 of 'awesome-database' created.

Channel    Version    Revision
stable     -          -
candidate  -          -
beta       -          -
edge       0.1        1

The edge channel is now open.
</code></pre>

<p>If we try to release this to <code>stable</code> the store will block us:</p>

<pre><code>$ snapcraft release awesome-database 1 stable
Revision 1 (devmode) cannot target a stable channel (stable, grade: devel)                                                                           
</code></pre>

<p>We are safe from messing up and making this available to our faithful
users. Now eventually we will <code>push</code> a revision worthy of releasing to the
stable channel:</p>

<pre><code>$ snapcraft push awesome-databse_0.1_amd64.snap
Uploading awesome-database_0.1_amd64.snap [=================] 100%
Processing....
Revision 10 of 'awesome-database' created.
</code></pre>

<p>Notice that the version is just a friendly identifier and what really
matters is the revision number the store generates for us. Now let&rsquo;s
go ahead and release this to <code>stable</code>:</p>

<pre><code>$ snapcraft release awesome-database 10 stable
Channel    Version    Revision
stable     0.1        10
candidate  ^          ^
beta       ^          ^
edge       0.1        10

The 'stable' channel is now open.
</code></pre>

<p>In this last channel map view for the architecture we are working with,
we can see that <code>edge</code> is going to be stuck on revision 10, and that
<code>beta</code> and <code>candidate</code> will be following <code>stable</code> which is on revision 10.
For some reason we decide that we will focus on stability and make our
CI/CD push to <code>beta</code> instead. This means that our <code>edge</code> channel will
slightly fall out of date, in order to avoid things like this we can
decide to <code>close</code> the channel:</p>

<pre><code>$ snapcraft close awesome-database edge
Arch    Channel    Version    Revision
amd64   stable     0.1        10
        candidate  ^          ^
        beta       ^          ^
        edge       ^          ^

The edge channel is now closed.
</code></pre>

<p>In this current state, all channels are following the <code>stable</code> channel
so people subscribed to <code>candidate</code>, <code>beta</code> and <code>edge</code> would be tracking
changes to that channel. If revision 11 is ever pushed to <code>stable</code> only,
people on the other channels would also see it.</p>

<p>This listing also provides us with a full architecture view, in this
case we have only been working with <code>amd64</code>.</p>

<h1 id="getting-more-information">Getting more information</h1>

<p>So some time passed and we want to know what was the history and status
of our snap in the store. There are two commands for this, the
straightforward one is to run <code>status</code> which will give us a familiar
result:</p>

<pre><code>$ snapcraft status awesome-database
Arch    Channel    Version    Revision
amd64   stable     0.1        10
        candidate  ^          ^
        beta       ^          ^
        edge       ^          ^
</code></pre>

<p>We can also get the full history:</p>

<pre><code>$ snapcraft history awesome-database
Rev.    Uploaded              Arch       Version    Channels
3       2016-09-30T12:46:21Z  amd64      0.1        stable*
...
...
...
2       2016-09-30T12:38:20Z  amd64      0.1        -
1       2016-09-30T12:33:55Z  amd64      0.1        -
</code></pre>

<h1 id="closing-remarks">Closing remarks</h1>

<p>I hope this gives an overview of the things you can do with the store
and more people start taking advantage of it!</p>

      </section>

      <footer class="post-card-meta">
          <img class="author-profile-image" src="../../img/avatar.png" alt="Author" />
          <span class="post-card-author"><a href="../../">Sergio Schvezov</a></span>
      </footer>
    </div>
</article>
    </div>

    <nav class="pagination" role="navigation">
      
          <a class="newer-posts" href="../../posts/ubuconla-2017-summit-summary/">&larr; <span class="hide">Next Post</span></a>
      
      <span class="page-number">&nbsp;</span>
      
          <a class="older-posts" href="../../posts/the-snapcraft-parts-ecosystem/"><span class="hide">Previous Post</span> &rarr;</a>
      
    </nav>

    
    
    

<div id="disqus_thread"></div>
<script>




var disqus_config = function () {
this.page.url = "http:\/\/blog.sergiusens.org\/posts\/making-your-snaps-available-to-the-store-using-snapcraft\/";  
this.page.identifier = "http:\/\/blog.sergiusens.org\/posts\/making-your-snaps-available-to-the-store-using-snapcraft\/"; 
};

(function() { 
var d = document, s = d.createElement('script');
s.src = 'https://sergiusens.disqus.com/embed.js';
s.setAttribute('data-timestamp', +new Date());
(d.head || d.body).appendChild(s);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>


  </div>
</main>



<footer class="site-footer outer">
  <div class="site-footer-content inner">
    <section class="copyright" style="line-height: 1.3em;">
      <a href="../../"></a> All rights reserved - 2018 <br>
      
    </section>
    <nav class="site-footer-nav">
        <a href="../../">Latest Posts</a>
        
        <a href="https://twitter.com/sergiusens" target="_blank" rel="noopener">Twitter</a>
        <a href="https://github.com/sergiusens" target="_blank" rel="noopener">Github</a>
        <a href="https://www.linkedin.com/in/SergioSchvezov" target="_blank" rel="noopener">LinkedIn</a>
        
    </nav>  
  </div>
</footer>

</div>
<script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
<script type="text/javascript" src="//code.jquery.com/jquery-3.2.1.min.js"></script>
<script type="text/javascript" src="js/jquery.fitvids.js"></script>

<script>hljs.initHighlightingOnLoad();</script>


  <!-- Google Analytics -->
  <script>
    var _gaq=[['_setAccount','UA-37640305-1'],['_trackPageview']];
    (function(d,t){var g=d.createElement(t),s=d.getElementsByTagName(t)[0];
    g.src=('https:'==location.protocol?'//ssl':'//www')+'.google-analytics.com/ga.js';
    s.parentNode.insertBefore(g,s)}(document,'script'));
  </script>



</body></html>
